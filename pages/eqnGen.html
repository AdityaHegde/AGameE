<html>
  <head>
  	<script type="text/javascript" src="/js/eqn_gen.js"></script>
    <script src="http://yui.yahooapis.com/3.10.3/build/yui/yui-min.js"></script>
    <style>
      .main-container {
        width: 100%;
      }
      .eqn-text-container {
        width: 500px;
        margin-left: auto;
        margin-right: auto;
      }
      .eqn-text {
        width: 300px;
      }
      .table {
        display: table;
      }
      .table-row {
        display: table-row;
      }
      .table-cell {
        display: table-cell;
      }
    </style>
  </head>
  <body>
  	<div class="main-container">
      <div class="eqn-text-container">
        <div><a href="#" class="eqn-text-add">Add Equation</a></div>
        <div class="eqn-text-div table"></div>
        <button id="eqn-process-bttn">Process</button>
        <div class="unkown-vars-div table"></div>
        <div class="simplified-eqn-div table"></div>
      </div>
  	</div>
  	<script type="text/javascript">

      YUI().use(['event', 'node', 'template'], function(Y) {
        var eqnGen,
            engine = new Y.Template(),
            eqnTxtTmpl = engine.compile('<div class="table-row">' +
              '<div class="table-cell"><input type="text" class="eqn-text"></div>' +
              '<div class="table-cell"><a href="#" class="remove-bttn">X</a></div>' +
            '</div>'),
            uknwnVarTmpl = engine.compile('<% for(var v in this.vars) { %>' +
              '<div class="table-row">' +
                '<div class="table-cell"><input type="checkbox" class="unkown-var-check"></div>' +
                '<div class="table-cell unknown-var-name"><%= v %></div>' +
              '</div>' +
            '<% } %>'),
            eqnSimplified = engine.compile('<div class="table-row"><%= this.eqnStr %></div>'),
            eqnTextsDiv = Y.one(".eqn-text-div"),
            unkownVarsDiv = Y.one(".unkown-vars-div"),
            eqnSimplifiedDiv = Y.one(".simplified-eqn-div");

        Y.one("#eqn-process-bttn").on("click", function(e) {
          var eqnStrs = [];
          eqnTextsDiv.all(".eqn-text").each(function(v, k) {
            eqnStrs.push(v.get("value"));
          });
          eqnGen = new EqnGen({equationStrings : eqnStrs});
          //unkownVarsDiv.setHTML(uknwnVarTmpl({vars : eqnGen.vars}));
          eqnGen.simplify();

          eqnSimplifiedDiv.setHTML("");
          for(var i = 0; i < eqnGen.equations.length; i++) {
            eqnSimplifiedDiv.append(eqnSimplified({eqnStr : eqnGen.equations[i].convertToString()}));
          }
        });

        eqnTextsDiv.append(eqnTxtTmpl());
        eqnTextsDiv.delegate("click", function(e) {
          //eqnTextsDiv.remove(e.target.ancestor(".table-row"));
          e.target.ancestor(".table-row").remove();
          e.preventDefault();
        }, ".remove-bttn");

        Y.one(".eqn-text-container").delegate("click", function (e) {
          eqnTextsDiv.append(eqnTxtTmpl());
          e.preventDefault();
        }, ".eqn-text-add")

      });
  	  
  	</script>
  </body>
</html>
